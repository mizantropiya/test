<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wildberries Analytics Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #2c6b2f;
            --primary-light: #e6f4ea;
            --secondary: #4a86e8;
            --secondary-light: #e8f0fe;
            --danger: #dc3545;
            --danger-light: #f8d7da;
            --warning: #ffc107;
            --warning-light: #fff3cd;
            --success: #28a745;
            --success-light: #d4edda;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border: #dee2e6;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            min-height: 100vh;
            color: var(--dark);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .dashboard-header {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border-left: 6px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        .header-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 0 16px 0 16px;
            font-size: 12px;
            font-weight: 600;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-icon {
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .logo-text h1 {
            color: var(--primary);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .logo-text p {
            color: var(--gray);
            font-size: 14px;
        }

        .account-info {
            background: var(--primary-light);
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            border: 2px solid rgba(44, 107, 47, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .stat-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .stat-icon.total { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .stat-icon.products { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .stat-icon.orders { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .stat-icon.turnover { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }

        .stat-title {
            font-size: 13px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 4px;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 24px;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* Products Table */
        .table-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .section-title h2 {
            color: var(--dark);
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .section-title p {
            color: var(--gray);
            font-size: 14px;
        }

        .controls-panel {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            position: relative;
            min-width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(44, 107, 47, 0.1);
        }

        .search-box i {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn i { font-size: 14px; }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, #3a8a3e 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(44, 107, 47, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary) 0%, #5a96e8 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 134, 232, 0.3);
        }

        .btn-outline {
            background: white;
            color: var(--dark);
            border: 1px solid var(--border);
        }

        .btn-outline:hover {
            background: var(--light);
            border-color: var(--gray);
        }

        /* Table */
        .table-wrapper {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        thead {
            background: var(--light);
        }

        th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--border);
            font-size: 14px;
            white-space: nowrap;
        }

        td {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        tbody tr {
            transition: background 0.2s;
        }

        tbody tr:hover {
            background: var(--light);
        }

        .stock-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            min-width: 60px;
            text-align: center;
            display: inline-block;
        }

        .stock-critical { background: var(--danger-light); color: var(--danger); }
        .stock-low { background: var(--warning-light); color: #856404; }
        .stock-normal { background: var(--success-light); color: var(--success); }
        .stock-high { background: var(--primary-light); color: var(--primary); }

        .turnover-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            min-width: 80px;
            text-align: center;
            display: inline-block;
        }

        .turnover-fast { background: linear-gradient(135deg, #28a745, #20c997); color: white; }
        .turnover-medium { background: linear-gradient(135deg, #ffc107, #fd7e14); color: white; }
        .turnover-slow { background: linear-gradient(135deg, #dc3545, #e83e8c); color: white; }

        .days-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            min-width: 70px;
            text-align: center;
            display: inline-block;
        }

        .days-urgent { background: linear-gradient(135deg, #dc3545, #e83e8c); color: white; }
        .days-warning { background: linear-gradient(135deg, #ffc107, #fd7e14); color: white; }
        .days-good { background: linear-gradient(135deg, #28a745, #20c997); color: white; }
        .days-excess { background: linear-gradient(135deg, #6c757d, #495057); color: white; }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-header h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
        }

        .card-header .badge {
            background: var(--primary-light);
            color: var(--primary);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .warehouse-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .warehouse-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px;
            background: var(--light);
            border-radius: 10px;
            border-left: 4px solid var(--secondary);
            transition: transform 0.2s;
        }

        .warehouse-item:hover {
            transform: translateX(4px);
        }

        .warehouse-info .name {
            font-weight: 600;
            font-size: 14px;
        }

        .warehouse-info .days {
            font-size: 12px;
            color: var(--gray);
            margin-top: 4px;
        }

        .warehouse-stats {
            text-align: right;
        }

        .warehouse-stats .stock {
            font-weight: 700;
            font-size: 16px;
            color: var(--dark);
        }

        .warehouse-stats .trend {
            font-size: 12px;
            color: var(--gray);
            margin-top: 2px;
        }

        .trend.up { color: var(--success); }
        .trend.down { color: var(--danger); }

        /* Action Card */
        .action-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
        }

        .action-card h3 {
            font-size: 20px;
            margin-bottom: 12px;
        }

        .action-card p {
            opacity: 0.9;
            margin-bottom: 24px;
            font-size: 14px;
        }

        /* Footer */
        .footer {
            margin-top: 40px;
            text-align: center;
            color: var(--gray);
            font-size: 14px;
            padding: 20px;
            border-top: 1px solid var(--border);
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--gray-light);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-top {
                flex-direction: column;
                align-items: stretch;
            }
            
            .account-info {
                align-self: flex-start;
            }
            
            .controls-panel {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <h3>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google –¢–∞–±–ª–∏—Ü—ã...</h3>
        <p id="loadingText">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –≤–∞—à–µ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É –¥–∞–Ω–Ω—ã—Ö</p>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="header-badge">LIVE DATA</div>
            
            <div class="header-top">
                <div class="logo-section">
                    <div class="logo-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="logo-text">
                        <h1>Wildberries Analytics</h1>
                        <p>–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü—ã</p>
                    </div>
                </div>
                
                <div class="account-info">
                    <i class="fas fa-store"></i>
                    <div>
                        <div>–ö–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞ Wildberries</div>
                        <div id="accountStats">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                    </div>
                </div>
            </div>

            <!-- Stats –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="stats-grid" id="statsGrid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon total">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <div>
                            <div class="stat-title">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                            <div class="stat-value" id="totalProducts">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon products">
                            <i class="fas fa-box"></i>
                        </div>
                        <div>
                            <div class="stat-title">–û–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫</div>
                            <div class="stat-value" id="totalStock">0 —à—Ç</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon orders">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div>
                            <div class="stat-title">–ó–∞–∫–∞–∑–æ–≤ –∑–∞ 30 –¥–Ω.</div>
                            <div class="stat-value" id="totalOrders">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon turnover">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div>
                            <div class="stat-title">–°—Ä. –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å</div>
                            <div class="stat-value" id="avgTurnover">0 –¥–Ω.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Products Table -->
            <div class="table-section">
                <div class="section-header">
                    <div class="section-title">
                        <h2><i class="fas fa-boxes"></i> –û—Å—Ç–∞—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
                        <p>–°—É–º–º–∞—Ä–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –≤—Å–µ—Ö —Å–∫–ª–∞–¥–∞—Ö Wildberries</p>
                    </div>
                    
                    <div class="controls-panel">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∞—Ä—Ç–∏–∫—É–ª—É...">
                        </div>
                        <button class="btn btn-outline" id="filterBtn">
                            <i class="fas fa-filter"></i> –§–∏–ª—å—Ç—Ä
                        </button>
                        <button class="btn btn-primary" id="refreshBtn">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>–¢–æ–≤–∞—Ä</th>
                                <th>–ê—Ä—Ç–∏–∫—É–ª</th>
                                <th>–ó–∞–∫–∞–∑–∞–Ω–æ (30 –¥–Ω.)</th>
                                <th>–û—Å—Ç–∞—Ç–∫–∏ –í–ë</th>
                                <th>–û—Å—Ç–∞—Ç–∫–∏ –ú–ü</th>
                                <th>–ü—Ä–æ–¥–∞–∂/–¥–µ–Ω—å</th>
                                <th>–û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å</th>
                                <th>–¢–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                            </tr>
                        </thead>
                        <tbody id="productsTable">
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>

                <div id="emptyState" class="empty-state" style="display: none;">
                    <i class="fas fa-database"></i>
                    <h3>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</h3>
                    <p>–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ", —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</p>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Warehouse Status -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-warehouse"></i> –°—Ç–∞—Ç—É—Å —Å–∫–ª–∞–¥–æ–≤</h3>
                        <div class="badge" id="updateTime">–°–µ–≥–æ–¥–Ω—è</div>
                    </div>
                    <div class="warehouse-list" id="warehouseList">
                        <div class="warehouse-item">
                            <div class="warehouse-info">
                                <div class="name">–®–∞–≥. 189</div>
                                <div class="days">5 –¥–Ω. –∑–∞–ø–∞—Å–∞</div>
                            </div>
                            <div class="warehouse-stats">
                                <div class="stock">201 —à—Ç</div>
                                <div class="trend up">‚Üë 12%</div>
                            </div>
                        </div>
                        <div class="warehouse-item">
                            <div class="warehouse-info">
                                <div class="name">–®–∞–≥. 461</div>
                                <div class="days">1 –¥–Ω. –∑–∞–ø–∞—Å–∞</div>
                            </div>
                            <div class="warehouse-stats">
                                <div class="stock">39 —à—Ç</div>
                                <div class="trend up">‚Üë 5%</div>
                            </div>
                        </div>
                        <div class="warehouse-item">
                            <div class="warehouse-info">
                                <div class="name">–®–∞–≥. 308</div>
                                <div class="days">1 –¥–Ω. –∑–∞–ø–∞—Å–∞</div>
                            </div>
                            <div class="warehouse-stats">
                                <div class="stock">15 —à—Ç</div>
                                <div class="trend down">‚Üì 3%</div>
                            </div>
                        </div>
                        <div class="warehouse-item">
                            <div class="warehouse-info">
                                <div class="name">–®–∞–≥. 114</div>
                                <div class="days">2 –¥–Ω. –∑–∞–ø–∞—Å–∞</div>
                            </div>
                            <div class="warehouse-stats">
                                <div class="stock">14 —à—Ç</div>
                                <div class="trend up">‚Üë 8%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <h3><i class="fas fa-cogs"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <div style="margin-top: 20px; display: flex; flex-direction: column; gap: 12px;">
                        <button class="btn btn-outline" id="exportBtn">
                            <i class="fas fa-file-excel"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                        </button>
                        <button class="btn btn-outline" id="alertBtn">
                            <i class="fas fa-bell"></i> –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                        </button>
                        <button class="btn btn-secondary" id="calculateBtn">
                            <i class="fas fa-calculator"></i> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø–æ—Å—Ç–∞–≤–∫–∏
                        </button>
                    </div>
                </div>

                <!-- Info Card -->
                <div class="action-card">
                    <h3>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç</h3>
                    <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤</p>
                    <button class="btn btn-primary" style="background: white; color: #667eea;">
                        <i class="fas fa-bolt"></i> –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>Wildberries Analytics Dashboard</strong> ‚Ä¢ v2.0 ‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü–µ–π</p>
            <p style="margin-top: 5px; font-size: 12px; color: #666;">–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ</p>
        </div>
    </div>

    <script>
        // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
        const CONFIG = {
            // –í–∞—à Google Apps Script URL (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π - —Ä—É—Å—Å–∫–∞—è "–æ" –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫—É—é "e")
            SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbwqNNFDffeGRXzJKglJJCQY4vB7eT91YNThz0S_013bGKY6MWdpTAYwj8sGbXX--sM/exec',
            
            // –ü–æ—Ä–æ–≥–∏ –¥–ª—è —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
            STOCK_THRESHOLDS: {
                CRITICAL: 5,    // –ö—Ä–∞—Å–Ω—ã–π: –º–µ–Ω—å—à–µ 5 —à—Ç
                LOW: 15,        // –ñ–µ–ª—Ç—ã–π: –º–µ–Ω—å—à–µ 15 —à—Ç
                HIGH: 50        // –ó–µ–ª–µ–Ω—ã–π: –±–æ–ª—å—à–µ 50 —à—Ç
            },
            TURNOVER_THRESHOLDS: {
                FAST: 15,       // –ë—ã—Å—Ç—Ä–∞—è –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å (–∑–µ–ª–µ–Ω—ã–π)
                MEDIUM: 30,     // –°—Ä–µ–¥–Ω—è—è (–∂–µ–ª—Ç—ã–π)
                SLOW: 60        // –ú–µ–¥–ª–µ–Ω–Ω–∞—è (–∫—Ä–∞—Å–Ω—ã–π)
            },
            DAYS_THRESHOLDS: {
                URGENT: 7,      // –°—Ä–æ—á–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å (–∫—Ä–∞—Å–Ω—ã–π)
                WARNING: 14,    // –°–∫–æ—Ä–æ –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å (–∂–µ–ª—Ç—ã–π)
                GOOD: 30,       // –ù–æ—Ä–º–∞ (–∑–µ–ª–µ–Ω—ã–π)
                EXCESS: 60      // –ò–∑–±—ã—Ç–æ–∫ (—Å–µ—Ä—ã–π)
            }
        };

        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let productsData = [];
        let filteredData = [];

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –Ω–∞ 1 —Å–µ–∫—É–Ω–¥—É, –∑–∞—Ç–µ–º –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            setTimeout(() => {
                loadData();
            }, 1000);
        });

        // ========== –ù–ê–°–¢–†–û–ô–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–ë–´–¢–ò–ô ==========
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            document.getElementById('refreshBtn').addEventListener('click', loadData);
            
            // –ü–æ–∏—Å–∫
            document.getElementById('searchInput').addEventListener('input', function(e) {
                filterProducts(e.target.value);
            });
            
            // –≠–∫—Å–ø–æ—Ä—Ç
            document.getElementById('exportBtn').addEventListener('click', exportToExcel);
            
            // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø–æ—Å—Ç–∞–≤–∫–∏
            document.getElementById('calculateBtn').addEventListener('click', calculateSupplies);
            
            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            document.getElementById('alertBtn').addEventListener('click', function() {
                alert('–§—É–Ω–∫—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!');
            });
            
            // –§–∏–ª—å—Ç—Ä
            document.getElementById('filterBtn').addEventListener('click', function() {
                alert('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω.');
            });
        }

        // ========== –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ==========
        async function loadData() {
            showLoading('–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Google –¢–∞–±–ª–∏—Ü–µ...');
            
            try {
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                console.log('–ü—ã—Ç–∞–µ–º—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫:', CONFIG.SCRIPT_URL);
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä t –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
                const url = `${CONFIG.SCRIPT_URL}?action=getData&t=${Date.now()}`;
                console.log('–ü–æ–ª–Ω—ã–π URL:', url);
                
                const response = await fetch(url, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${response.status} ${response.statusText}`);
                }
                
                const result = await response.json();
                console.log('–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ:', result);
                
                if (result.success) {
                    processData(result.data || result);
                    updateUI();
                    showSuccess('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
                } else {
                    throw new Error(result.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                
                // –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
                try {
                    console.log('–ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å...');
                    const altUrl = `${CONFIG.SCRIPT_URL}?t=${Date.now()}`;
                    const altResponse = await fetch(altUrl);
                    
                    if (altResponse.ok) {
                        const altResult = await altResponse.json();
                        console.log('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', altResult);
                        
                        if (altResult.data || altResult.success) {
                            processData(altResult.data || altResult);
                            updateUI();
                            showSuccess('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥)');
                            return;
                        }
                    }
                } catch (altError) {
                    console.error('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Ç–æ–∂–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:', altError);
                }
                
                // –ï—Å–ª–∏ –æ–±–∞ –º–µ—Ç–æ–¥–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
                showError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Google –¢–∞–±–ª–∏—Ü–µ. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ.');
                showDemoData();
            } finally {
                hideLoading();
            }
        }

        // ========== –û–ë–†–ê–ë–û–¢–ö–ê –î–ê–ù–ù–´–• ==========
        function processData(data) {
            console.log('–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ:', data);
            
            // –ï—Å–ª–∏ data - —ç—Ç–æ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∫–∞–∫ –µ—Å—Ç—å
            // –ï—Å–ª–∏ data - –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª–µ–º data, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
            let productsArray = Array.isArray(data) ? data : (data.data || []);
            
            // –ï—Å–ª–∏ —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –¥—Ä—É–≥–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º
            if (!Array.isArray(productsArray) && typeof productsArray === 'object') {
                productsArray = Object.values(productsArray);
            }
            
            console.log('–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤:', productsArray);
            
            if (productsArray.length === 0) {
                // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –º–∞—Å—Å–∏–≤–µ, –≤–æ–∑–º–æ–∂–Ω–æ –¥–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
                // –ü–æ–ø—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                showDemoData();
                return;
            }
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
            productsData = productsArray.map((item, index) => {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
                const product = {
                    id: index + 1,
                    name: item.name || item.supplierArticle || item['–ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞'] || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
                    nmId: item.nmId || item.article || item['nmId'] || '',
                    chrtId: item.chrtId || item['chrtId'] || '',
                    ordered: parseFloat(item.ordered || item.orderedQty || item['–ó–∞–∫–∞–∑–∞–Ω–æ —à—Ç (30 –¥–Ω–µ–π)'] || 0),
                    wbStock: parseFloat(item.wbStock || item['–û—Å—Ç–∞—Ç–∫–∏ –í–ë'] || 0),
                    mpStock: parseFloat(item.mpStock || item.myStock || item['–û—Å—Ç–∞—Ç–∫–∏ –ú–ü'] || 0),
                    avgPerDay: parseFloat(item.avgPerDay || item.avgOrdersPerDay || item['–°—Ä–µ–¥–Ω–µ–µ –ø—Ä–æ–¥–∞–∂ –≤ –¥–µ–Ω—å'] || 0),
                    turnover: parseFloat(item.turnover || item['–û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å (–¥–Ω–µ–π)'] || 0),
                    reorderPoint: parseFloat(item.reorderPoint || item['–¢–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞'] || 0)
                };
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
                product.totalStock = product.wbStock + product.mpStock;
                product.daysOfSupply = product.avgPerDay > 0 ? 
                    Math.round(product.totalStock / product.avgPerDay) : 
                    (product.totalStock > 0 ? 999 : 0);
                product.status = getProductStatus(product);
                
                return product;
            }).filter(product => product.name && product.name !== '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è');
            
            console.log('–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:', productsData);
            
            filteredData = [...productsData];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
            document.getElementById('updateTime').textContent = 
                new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ==========
        function updateUI() {
            updateStats();
            updateTable();
            updateAccountInfo();
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–ò–°–¢–ò–ö ==========
        function updateStats() {
            if (productsData.length === 0) return;
            
            const totalProducts = productsData.length;
            const totalStock = productsData.reduce((sum, p) => sum + p.totalStock, 0);
            const totalOrders = productsData.reduce((sum, p) => sum + p.ordered, 0);
            const avgTurnover = productsData.reduce((sum, p) => sum + p.turnover, 0) / totalProducts;
            
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalStock').textContent = `${totalStock} —à—Ç`;
            document.getElementById('totalOrders').textContent = totalOrders;
            document.getElementById('avgTurnover').textContent = `${avgTurnover.toFixed(1)} –¥–Ω.`;
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –¢–ê–ë–õ–ò–¶–´ –¢–û–í–ê–†–û–í ==========
        function updateTable() {
            const tableBody = document.getElementById('productsTable');
            const emptyState = document.getElementById('emptyState');
            
            if (filteredData.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            tableBody.innerHTML = filteredData.map(product => `
                <tr>
                    <td><strong>${escapeHtml(product.name)}</strong></td>
                    <td><code>${product.nmId}</code></td>
                    <td><strong>${product.ordered}</strong></td>
                    <td>
                        <span class="stock-badge ${getStockClass(product.wbStock)}">
                            ${product.wbStock} —à—Ç
                        </span>
                    </td>
                    <td>${product.mpStock} —à—Ç</td>
                    <td><strong>${product.avgPerDay.toFixed(2)}</strong></td>
                    <td>
                        <span class="turnover-badge ${getTurnoverClass(product.turnover)}">
                            ${product.turnover.toFixed(1)} –¥–Ω.
                        </span>
                    </td>
                    <td><strong style="color: ${product.reorderPoint > 0 ? '#dc3545' : '#28a745'}">
                        ${product.reorderPoint}
                    </strong></td>
                    <td>
                        <span class="days-badge ${getDaysClass(product.daysOfSupply)}">
                            ${product.daysOfSupply === 999 ? '‚àû' : product.daysOfSupply} –¥–Ω.
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–§–û–†–ú–ê–¶–ò–ò –ê–ö–ö–ê–£–ù–¢–ê ==========
        function updateAccountInfo() {
            const accountStats = document.getElementById('accountStats');
            
            if (productsData.length > 0) {
                const urgentCount = productsData.filter(p => p.status === 'urgent').length;
                accountStats.innerHTML = `
                    ${productsData.length} –ø–æ–∑–∏—Ü–∏–π ‚Ä¢ ${urgentCount} —Å—Ä–æ—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
                `;
            }
        }

        // ========== –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –¢–û–í–ê–†–û–í ==========
        function filterProducts(searchTerm) {
            if (!searchTerm.trim()) {
                filteredData = [...productsData];
            } else {
                const term = searchTerm.toLowerCase();
                filteredData = productsData.filter(product =>
                    product.name.toLowerCase().includes(term) ||
                    (product.nmId && product.nmId.toString().toLowerCase().includes(term)) ||
                    (product.chrtId && product.chrtId.toString().toLowerCase().includes(term))
                );
            }
            
            updateTable();
        }

        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        function getProductStatus(product) {
            const days = product.daysOfSupply;
            
            if (days === 0 || (product.wbStock === 0 && product.mpStock === 0)) {
                return 'urgent';
            } else if (days <= CONFIG.DAYS_THRESHOLDS.URGENT) {
                return 'urgent';
            } else if (days <= CONFIG.DAYS_THRESHOLDS.WARNING) {
                return 'warning';
            } else if (days <= CONFIG.DAYS_THRESHOLDS.GOOD) {
                return 'good';
            } else {
                return 'excess';
            }
        }

        function getStockClass(stock) {
            if (stock === 0) return 'stock-critical';
            if (stock <= CONFIG.STOCK_THRESHOLDS.CRITICAL) return 'stock-critical';
            if (stock <= CONFIG.STOCK_THRESHOLDS.LOW) return 'stock-low';
            if (stock >= CONFIG.STOCK_THRESHOLDS.HIGH) return 'stock-high';
            return 'stock-normal';
        }

        function getTurnoverClass(turnover) {
            if (turnover <= CONFIG.TURNOVER_THRESHOLDS.FAST) return 'turnover-fast';
            if (turnover <= CONFIG.TURNOVER_THRESHOLDS.MEDIUM) return 'turnover-medium';
            return 'turnover-slow';
        }

        function getDaysClass(days) {
            if (days === 0 || days === 999) return 'days-urgent';
            if (days <= CONFIG.DAYS_THRESHOLDS.URGENT) return 'days-urgent';
            if (days <= CONFIG.DAYS_THRESHOLDS.WARNING) return 'days-warning';
            if (days <= CONFIG.DAYS_THRESHOLDS.GOOD) return 'days-good';
            return 'days-excess';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ========== –î–ï–ú–û-–î–ê–ù–ù–´–ï (–µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç) ==========
        function showDemoData() {
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ');
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const demoProducts = [
                { id: 1, name: '–∫–∞–Ω—å–æ–Ω 22  10—à—Ç', nmId: '505814972', ordered: 49, wbStock: 17, mpStock: 0, avgPerDay: 1.63, turnover: 10.4, reorderPoint: 32, totalStock: 17, daysOfSupply: 10, status: 'good' },
                { id: 2, name: '–∫–∞–Ω—å–æ–Ω 62', nmId: '506843320', ordered: 49, wbStock: 24, mpStock: 0, avgPerDay: 1.63, turnover: 14.7, reorderPoint: 25, totalStock: 24, daysOfSupply: 15, status: 'good' },
                { id: 3, name: '–∫–∞–Ω—å–æ–Ω 62 10—à—Ç', nmId: '506843324', ordered: 41, wbStock: 14, mpStock: 0, avgPerDay: 1.37, turnover: 10.2, reorderPoint: 27, totalStock: 14, daysOfSupply: 10, status: 'good' },
                { id: 4, name: '–∫–∞–Ω—å–æ–Ω 22  4—à—Ç', nmId: '505814969', ordered: 38, wbStock: 1, mpStock: 0, avgPerDay: 1.27, turnover: 0.8, reorderPoint: 37, totalStock: 1, daysOfSupply: 1, status: 'urgent' },
                { id: 5, name: '–∫–∞–Ω—å–æ–Ω 22', nmId: '505814968', ordered: 35, wbStock: 0, mpStock: 0, avgPerDay: 1.17, turnover: 0.0, reorderPoint: 35, totalStock: 0, daysOfSupply: 0, status: 'urgent' },
                { id: 6, name: '–∫–∞–Ω—å–æ–Ω 62 4—à—Ç', nmId: '506843321', ordered: 29, wbStock: 8, mpStock: 0, avgPerDay: 0.97, turnover: 8.3, reorderPoint: 21, totalStock: 8, daysOfSupply: 8, status: 'warning' },
                { id: 7, name: '–∫–∞–Ω—å–æ–Ω 22  6—à—Ç', nmId: '505814970', ordered: 23, wbStock: 16, mpStock: 0, avgPerDay: 0.77, turnover: 20.9, reorderPoint: 7, totalStock: 16, daysOfSupply: 21, status: 'good' },
                { id: 8, name: '—Ç—É–ª—É—Ä 51', nmId: '526331759', ordered: 11, wbStock: 0, mpStock: 0, avgPerDay: 0.37, turnover: 0.0, reorderPoint: 11, totalStock: 0, daysOfSupply: 0, status: 'urgent' },
                { id: 9, name: '–∫–∞–Ω—å–æ–Ω 22  8—à—Ç', nmId: '505814971', ordered: 6, wbStock: 0, mpStock: 0, avgPerDay: 0.20, turnover: 0.0, reorderPoint: 6, totalStock: 0, daysOfSupply: 0, status: 'urgent' },
                { id: 10, name: '–∫–∞–Ω—å–æ–Ω 62 6—à—Ç', nmId: '506843323', ordered: 5, wbStock: 25, mpStock: 0, avgPerDay: 0.17, turnover: 150.0, reorderPoint: 0, totalStock: 25, daysOfSupply: 147, status: 'excess' },
                { id: 11, name: '—Ç—É–ª—É—Ä —Ñ–æ–Ω 82', nmId: '526331753', ordered: 5, wbStock: 0, mpStock: 0, avgPerDay: 0.17, turnover: 0.0, reorderPoint: 5, totalStock: 0, daysOfSupply: 0, status: 'urgent' },
                { id: 12, name: '—Ç—É–ª—É—Ä —Ñ–æ–Ω 61', nmId: '526331755', ordered: 3, wbStock: 3, mpStock: 0, avgPerDay: 0.10, turnover: 30.0, reorderPoint: 0, totalStock: 3, daysOfSupply: 30, status: 'good' },
                { id: 13, name: '–¢—É–ª—É—Ä —Ñ–æ–Ω 21', nmId: '526331749', ordered: 2, wbStock: 1, mpStock: 0, avgPerDay: 0.07, turnover: 15.0, reorderPoint: 1, totalStock: 1, daysOfSupply: 14, status: 'warning' },
                { id: 14, name: '—Ç—É–ª—É—Ä —Ñ–æ–Ω 11', nmId: '526331751', ordered: 1, wbStock: 0, mpStock: 0, avgPerDay: 0.03, turnover: 0.0, reorderPoint: 1, totalStock: 0, daysOfSupply: 0, status: 'urgent' },
                { id: 15, name: '—Ç—É–ª—É—Ä 11', nmId: '526331752', ordered: 1, wbStock: 0, mpStock: 0, avgPerDay: 0.03, turnover: 0.0, reorderPoint: 1, totalStock: 0, daysOfSupply: 0, status: 'urgent' }
            ];
            
            productsData = demoProducts;
            filteredData = [...productsData];
            updateUI();
            
            document.getElementById('accountStats').innerHTML = '15 –ø–æ–∑–∏—Ü–∏–π ‚Ä¢ 7 —Å—Ä–æ—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ (–¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ)';
        }

        // ========== –≠–ö–°–ü–û–†–¢ –í EXCEL ==========
        function exportToExcel() {
            const data = filteredData.length > 0 ? filteredData : productsData;
            
            if (data.length === 0) {
                alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
                return;
            }
            
            const headers = ['–¢–æ–≤–∞—Ä', '–ê—Ä—Ç–∏–∫—É–ª', '–ó–∞–∫–∞–∑–∞–Ω–æ (30 –¥–Ω.)', '–û—Å—Ç–∞—Ç–∫–∏ –í–ë', '–û—Å—Ç–∞—Ç–∫–∏ –ú–ü', '–ü—Ä–æ–¥–∞–∂/–¥–µ–Ω—å', '–û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å', '–¢–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞', '–î–Ω–µ–π –∑–∞–ø–∞—Å–∞'];
            const rows = data.map(p => [
                p.name,
                p.nmId,
                p.ordered,
                p.wbStock,
                p.mpStock,
                p.avgPerDay.toFixed(2),
                p.turnover.toFixed(1),
                p.reorderPoint,
                p.daysOfSupply === 999 ? '‚àû' : p.daysOfSupply
            ]);
            
            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `wildberries_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showSuccess('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV —Ñ–∞–π–ª');
        }

        // ========== –†–ê–°–ß–Å–¢ –ü–û–°–¢–ê–í–û–ö ==========
        function calculateSupplies() {
            const urgentProducts = productsData.filter(p => p.status === 'urgent');
            const warningProducts = productsData.filter(p => p.status === 'warning');
            
            let message = 'üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ—Å—Ç–∞–≤–∫–∞–º:\n\n';
            
            if (urgentProducts.length > 0) {
                message += `üö® –°–†–û–ß–ù–û –ó–ê–ö–ê–ó–ê–¢–¨ (${urgentProducts.length} —Ç–æ–≤–∞—Ä–æ–≤):\n`;
                urgentProducts.forEach(p => {
                    message += `‚Ä¢ ${p.name}: ${p.reorderPoint} —à—Ç (–æ—Å—Ç–∞–ª–æ—Å—å ${p.totalStock} —à—Ç)\n`;
                });
                message += '\n';
            }
            
            if (warningProducts.length > 0) {
                message += `‚ö†Ô∏è  –°–ö–û–†–û –ó–ê–ö–ê–ó–´–í–ê–¢–¨ (${warningProducts.length} —Ç–æ–≤–∞—Ä–æ–≤):\n`;
                warningProducts.forEach(p => {
                    message += `‚Ä¢ ${p.name}: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º ${Math.ceil(p.avgPerDay * 7)} —à—Ç –Ω–∞ –Ω–µ–¥–µ–ª—é\n`;
                });
            }
            
            if (urgentProducts.length === 0 && warningProducts.length === 0) {
                message = '‚úÖ –í—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –Ω–æ—Ä–º–µ. –°—Ä–æ—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.';
            }
            
            alert(message);
        }

        // ========== –£–¢–ò–õ–ò–¢–´ –î–õ–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô ==========
        function showLoading(message) {
            const overlay = document.getElementById('loadingOverlay');
            const text = document.getElementById('loadingText');
            
            text.textContent = message;
            overlay.style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        function showSuccess(message) {
            // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            console.log('‚úÖ ' + message);
        }

        function showError(message) {
            console.error('‚ùå ' + message);
        }

        // ========== –ó–ê–ü–£–°–ö –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´ ==========
        // –£–∂–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ DOMContentLoaded
    </script>
</body>
</html>
